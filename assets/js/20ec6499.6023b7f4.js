"use strict";(self.webpackChunkpollerdox=self.webpackChunkpollerdox||[]).push([[341],{4933:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"install/cloudkey","title":"CloudKey","description":"Introduction","source":"@site/docs/install/cloudkey.md","sourceDirName":"install","slug":"/install/cloudkey","permalink":"/docs/install/cloudkey","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"cloudkey","title":"CloudKey"},"sidebar":"someSidebar","previous":{"title":"Windows","permalink":"/docs/install/windows"},"next":{"title":"Synology","permalink":"/docs/install/synology"}}');var t=l(4848),a=l(8453);const s={id:"cloudkey",title:"CloudKey"},r=void 0,o={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Installation",id:"installation",level:2},{value:"Legacy Firmware",id:"legacy-firmware",level:3},{value:"Install Grafana",id:"install-grafana",level:4},{value:"Install InfluxDB",id:"install-influxdb",level:4},{value:"Install Unpoller",id:"install-unpoller",level:4},{value:"Current Firmware: <code>unifios</code>",id:"current-firmware-unifios",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:["Two methods are available for installation on a CloudKey, CloudKey Gen2 or CloudKey G2+.\nThe method depends on whether the device is running ",(0,t.jsx)(n.code,{children:"unifos"})," or not."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"These solutions are community-supplied and have a limited user base."})}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.h3,{id:"legacy-firmware",children:"Legacy Firmware"}),"\n",(0,t.jsxs)(n.p,{children:["These directions are for devices not running UnifiOS.\nReferenced from a user page ",(0,t.jsx)(n.a,{href:"https://www.robertcampbell.dev/2020/07/installing-unifi-poller-influxdb-and.html",children:"here"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"install-grafana",children:"Install Grafana"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["From: ",(0,t.jsx)(n.a,{href:"https://grafana.com/docs/grafana/latest/installation/debian/",children:"https://grafana.com/docs/grafana/latest/installation/debian/"})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'curl https://packages.grafana.com/gpg.key | sudo apt-key add -\napt install -y apt-transport-https\nadd-apt-repository "deb https://packages.grafana.com/oss/deb stable main"\napt -y update && sudo apt -y install grafana\nsystemctl daemon-reload\nsystemctl start grafana-server\nsystemctl enable grafana-server.service\nsystemctl status grafana-server\n'})}),"\n",(0,t.jsx)(n.h4,{id:"install-influxdb",children:"Install InfluxDB"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"apt-get update\napt-get install -y influxdb influxdb-client\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Add user to influx; ",(0,t.jsx)(n.a,{href:"https://v2.docs.influxdata.com/v2.0/users/create-user/",children:"from here"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"influx -host localhost -port 8086\nCREATE DATABASE unifi\nUSE unifi\nCREATE USER unifipoller WITH PASSWORD 'unifipoller' WITH ALL PRIVILEGES\nGRANT ALL ON unifi TO unifipoller\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["For InfluxDB on a CloudKey it is ",(0,t.jsx)(n.em,{children:"highly"})," advisable to add a retention policy to\nprevent the database from growing in uncontrollably."]})}),"\n",(0,t.jsx)(n.h4,{id:"install-unpoller",children:"Install Unpoller"}),"\n",(0,t.jsxs)(n.p,{children:["Linux repository hosting provided by\n",(0,t.jsx)(n.a,{href:"http://packagecloud.io",children:(0,t.jsx)(n.img,{src:"https://docs.golift.io/integrations/packagecloud-full.png",alt:"packagecloud",title:"PackageCloud.io"})})]}),"\n",(0,t.jsx)(n.p,{children:"Install the Go Lift package repo and Unpoller with this command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"curl -s https://golift.io/repo.sh | sudo bash -s - unpoller\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"current-firmware-unifios",children:["Current Firmware: ",(0,t.jsx)(n.code,{children:"unifios"})]}),"\n",(0,t.jsxs)(n.p,{children:["There is an existing suite for installing ",(0,t.jsx)(n.code,{children:"podman"})," containers to run on ",(0,t.jsx)(n.code,{children:"unifios"})," -\nsee ",(0,t.jsx)(n.a,{href:"https://github.com/boostchicken/udm-utilities",children:"here"}),".  At the time of writing  we are not\naware of any user implementing Unpoller using this method, but it should be straightforward."]}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The config file is located at ",(0,t.jsx)(n.code,{children:"/etc/unpoller/up.conf"})," and\nit is explained on the ",(0,t.jsx)(n.a,{href:"../install/configuration",children:"Application Configuration"})," page."]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Don't forget the ",(0,t.jsx)(n.a,{href:"../dependencies/grafana#plugins",children:"Grafana Plugins"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Finish ",(0,t.jsx)(n.a,{href:"../install/grafana",children:"Setting-up Grafana"}),"."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>s,x:()=>r});var i=l(6540);const t={},a=i.createContext(t);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);